<!DOCTYPE html>
<html lang="es-ES" dir="ltr"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>
  
                           
     


<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.136.5">
<title>Tutorial: Mapa de la zona urbana de la Región Metropolitana de Santiago en R | Blog</title>


<meta property="twitter:site" content="@bastimapache">
<meta property="twitter:creator" content="@bastimapache">







  
    
  
<meta name="description" content="Blog y portafolio de proyectos de Bastián Olea, sociólogx y analista de datos">


<meta property="og:site_name" content="Blog">
<meta property="og:title" content="Tutorial: Mapa de la zona urbana de la Región Metropolitana de Santiago en R | Blog">
<meta property="og:description" content="Blog y portafolio de proyectos de Bastián Olea, sociólogx y analista de datos" />
<meta property="og:type" content="page" />
<meta property="og:url" content="http://localhost:4321/blog/tutorial_mapa_urbano/" />
<meta property="og:locale" content="es-ES">




    
        <meta property="og:image" content="http://localhost:4321/blog/sidebar-listing.png" >
        <meta property="twitter:card" content="summary_large_image">
        <meta name="twitter:image" content="http://localhost:4321/blog/sidebar-listing.png" >
    
    
  
  <meta itemprop="name" content="Tutorial: Mapa de la zona urbana de la Región Metropolitana de Santiago en R">
  <meta itemprop="description" content="Este tutorial de R te explicará paso a paso a cómo obtener mapas de todo Chile usando el paquete {chilemapas} desarrollado por Mauricio Vargas, y hacer gráficos con estos mapas usando {ggplot2}.
En la primera parte veremos cómo obtener los mapas y cómo visualizar datos comunales usando mapas en R.
Luego, nos enfrentaremos a un problema común que se tiene al graficar un mapa de la Región Metropolitana de Santiago, que tiene que ver con la diferencia entre los límites comunales reales de cada comuna y los límites urbanos de las comunas. Es la diferencia entre tener un mapa de la RM que abarque sectores rurales como Paine y que llegue hasta Argentina, o un mapa que demarque la zona urbana de Santiago, aproximadamente correspondiente a la zona que atravieza el anillo Vespucio.">
  <meta itemprop="datePublished" content="2024-06-12T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-06-12T00:00:00+00:00">
  <meta itemprop="wordCount" content="2782">
  <meta itemprop="keywords" content="Mapas,Chile,Gráficos">
  
  <!--[if IE]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  
  
  <link rel="stylesheet" href="/style.main.min.c4fbf76e54adf7e7a1073b995dfaf4f393e11c67c30cfd5b19d29824f2cee0f0.css" integrity="sha256-xPv3blSt9&#43;ehBzuZXfr085PhHGfDDP1bGdKYJPLO4PA=" media="screen">
  
  
  <script src="/panelset.min.ed1ac24b6e16f4e2481e3d1d098ae66f5bc77438aef619e6e266d8ac5b00dc72.js" type="text/javascript"></script>
  
  
  <script src="/main.min.bebab142e3ad4c47834f81e426b8adcd5b747151cc6f7d8358a68b4a30c7ff48.js" type="text/javascript"></script>
</head>
<body>
      <div class="grid-container">
<header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role="banner">
  <nav class="site-nav db dt-l w-100" role="navigation">
    <a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href="http://localhost:4321/" title="Home">
      <img src="/img/logo.png" class="dib db-l h2 w-auto" alt="Blog">
    </a>
    <div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked">
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 active" href="/blog/" title="Bastián Olea: Blog de R">Blog R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/apps/" title="Bastián Olea: Apps">Apps</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/clases/" title="Bastián Olea: Clases">Clases</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/tags/" title="Bastián Olea: Blog">Temas</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/categories/tutoriales/" title="Bastián Olea: Tutoriales">Tutoriales</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/blog/r_introduccion/" title="Bastián Olea: Tutoriales">Intro a R</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/about/" title="Bastián Olea: Sobre mi">Yo</a>
      
        
        
        
      <a class="link f6 f5-l dib pv1 ph2 " href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      
      <div class="dib v-mid">
        <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

      </div>
      
    </div>
  </nav>
</header>

<main class="page-main pa4" role="main">
  <section class="page-content mw7 center">
    <article class="post-content pa0 ph4-l">
      <header class="post-header">
        <h1 class="f1 lh-solid measure-narrow mb3 fw4">Tutorial: Mapa de la zona urbana de la Región Metropolitana de Santiago en R</h1>
        
        
        <p class="f7 db mv0 ttu">12/6/2024</p>
        
        
        
  <dl class="f6 lh-copy">
    <em><dd class="fw5 ml0">Temas:  <a href="http://localhost:4321/tags/mapas">mapas</a>  <a href="http://localhost:4321/tags/chile">chile</a>  <a href="http://localhost:4321/tags/gr%C3%A1ficos">gráficos</a> </dd></em>
  </dl>


        
      
      <div class="ph0 pt5">
        
    
    
    
      
    
    
    
    
    
      
      
  <a class="btn-links mr2 ba dib" href="https://github.com/bastianolea/tutorial_r_mapa_urbano_rm" target="_blank" rel="noopener"><i class="fab fa-github fa-lg fa-fw mr2"></i>código</a>


      </div>
      

      </header>
      <section class="post-body pt5 pb4">
        <p>Este tutorial de R te explicará paso a paso a cómo obtener mapas de todo Chile usando el paquete 
<a href="https://github.com/pachadotdev/chilemapas" target="_blank" rel="noopener"><code>{chilemapas}</code> desarrollado por Mauricio Vargas</a>, y hacer gráficos con estos mapas usando <code>{ggplot2}</code>.</p>
<p>En la primera parte veremos cómo <strong>obtener los mapas</strong> y cómo <strong>visualizar datos comunales</strong> usando mapas en R.</p>
<p>Luego, nos enfrentaremos a un problema común que se tiene al graficar un mapa de la Región Metropolitana de Santiago, que tiene que ver con la diferencia entre los límites comunales reales de cada comuna y los <strong>límites urbanos</strong> de las comunas. Es la diferencia entre tener un mapa de la RM que abarque sectores rurales como Paine y que llegue hasta Argentina, o un mapa que demarque la zona urbana de Santiago, aproximadamente correspondiente a la zona que atravieza el anillo Vespucio.</p>
<p>Graficando un mapa de la superficie urbana de la Región Metropolitana, obtenemos una figura que es más familiar al habitante promedio de la RM, y que es la que usalmente vemos en la cotidianeidad, en contraste con un mapa geográficamente correcto de todo el territorio abarcado por la región.</p>




<h3 id="paquetes">Paquetes
  <a href="#paquetes"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Primero cargamos los paquetes que usaremos en este tutorial:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">dplyr</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#manipulación de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">janitor</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#limpieza de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">stringr</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#manipulación de texto</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># mapas</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#mapas de chile</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">sf</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#manipulación de mapas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># gráficos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">ggplot2</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#visualización de datos</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">viridis</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#escalas de colores</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">scales</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#escalas numéricas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># web scraping</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rvest</span><span style="color:#908caa">)</span> <span style="color:#6e6a86">#obtener datos desde páginas de internet</span>
</span></span></code></pre></div>



<h3 id="obtener-un-mapa-regional">Obtener un mapa regional
  <a href="#obtener-un-mapa-regional"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h3>
<p>Primero, usaremos <code>{chilemapas}</code> para obtener los datos geográficos (polígonos o shapes) necesarios para producir un mapa de la Región Metropolitana:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">::</span><span style="color:#ea9a97">mapa_comunas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">::</span><span style="color:#ea9a97">codigos_territoriales</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">matches</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;comuna&#34;</span><span style="color:#908caa">)),</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;codigo_comuna&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span><span style="color:#908caa">==</span><span style="color:#f6c177">&#34;13&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code># A tibble: 52 × 5
   codigo_comuna codigo_provincia codigo_region                         geometry
   &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;                       &lt;MULTIPOLYGON [°]&gt;
 1 13404         134              13            (((-70.61396 -33.73862, -70.609…
 2 13402         134              13            (((-70.61396 -33.73862, -70.623…
 3 13124         131              13            (((-70.75679 -33.38348, -70.780…
 4 13103         131              13            (((-70.72154 -33.43661, -70.724…
 5 13301         133              13            (((-70.37256 -33.10578, -70.376…
 6 13303         133              13            (((-70.72028 -32.95297, -70.723…
 7 13302         133              13            (((-70.79191 -33.17296, -70.783…
 8 13107         131              13            (((-70.59589 -33.33656, -70.590…
 9 13104         131              13            (((-70.68968 -33.36587, -70.682…
10 13504         135              13            (((-71.27576 -33.40409, -71.263…
# ℹ 42 more rows
# ℹ 1 more variable: nombre_comuna &lt;chr&gt;
</code></pre>
<p>Podemos ver que obtuvimos un <em>dataframe</em> donde cada fila es una comuna, individualizada por su nombre y su código único territorial (<code>codigo_comuna</code>).</p>
<p>En esta tabla de datos, la columna <code>geometry</code> contiene la información geográfica de cada comuna, lo que permite visualizarlas como un mapa.</p>
<p>Por lo tanto, en cada fila tenemos información geográfica que representa polígonos comunales, donde cada polígono (o conjuto de polígonos) se corresponde con los datos existentes en las demás columnas, que pueden ser información como sus nombres, su población, o cualquier otra.</p>
<p>Podemos visualizar este mapa de manera sencilla, usando <code>{ggplot2}</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">col</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_prueba-1.png" width="768" />
<p>Obtuvimos un mapa básico de todas las comunas de la Región Metropolitana de Santiago.</p>
<p>Ahora, hagamos una prueba para aprender a visualizar datos en la di este mapa. Para esto, crearemos una nueva variable donde algunas comunas tengan valores distintos. Podemos crear la nueva variable a partir de la columna <code>nombre_comuna</code>, aunque siempre es preferible hacerlo en base a la columna <code>codigo_comuna</code>, dado que los códigos únicos territoriales son identificadores únicos para cada comuna, mientras que los nombres de las comunas son más impredecibles (por ejemplo, pueden venir sin tilde, pueden venir en mayúsculas, o derechamente mal escritos).</p>
<p>Usamos la función <code>case_when()</code> para asignar valores ficticios sobre algunas comunas, y los visualizamos en el mapa:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_datos</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># crear una variable para comunas específicas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">variable</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">case_when</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Paine&#34;</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">&#34;Bacán&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Buin&#34;</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">&#34;Penca&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;La Florida&#34;</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">&#34;Bacán&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Cerrillos&#34;</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">&#34;Bacán&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Nunoa&#34;</span> <span style="color:#908caa">~</span> <span style="color:#f6c177">&#34;Penca&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">variable</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_datos</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code># A tibble: 52 × 4
   nombre_comuna codigo_comuna variable                                 geometry
   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;                          &lt;MULTIPOLYGON [°]&gt;
 1 Paine         13404         Bacán    (((-70.61396 -33.73862, -70.60917 -33.7…
 2 Buin          13402         Penca    (((-70.61396 -33.73862, -70.62304 -33.7…
 3 Pudahuel      13124         &lt;NA&gt;     (((-70.75679 -33.38348, -70.78087 -33.4…
 4 Cerro Navia   13103         &lt;NA&gt;     (((-70.72154 -33.43661, -70.72426 -33.4…
 5 Colina        13301         &lt;NA&gt;     (((-70.37256 -33.10578, -70.37609 -33.1…
 6 Tiltil        13303         &lt;NA&gt;     (((-70.72028 -32.95297, -70.72329 -32.9…
 7 Lampa         13302         &lt;NA&gt;     (((-70.79191 -33.17296, -70.7833 -33.18…
 8 Huechuraba    13107         &lt;NA&gt;     (((-70.59589 -33.33656, -70.59023 -33.3…
 9 Conchali      13104         &lt;NA&gt;     (((-70.68968 -33.36587, -70.68201 -33.3…
10 Maria Pinto   13504         &lt;NA&gt;     (((-71.27576 -33.40409, -71.26337 -33.4…
# ℹ 42 more rows
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># visualizar</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_datos</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">variable</span><span style="color:#908caa">),</span> <span style="color:#6e6a86">#usamos la variable que creamos como relleno de las comunas</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">col</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_fill_manual-1.png" width="768" />
<p>Ahora, pasaremos a usar datos reales sobre nuestro mapa comunal. Pero vez de entregarles datos copiados y pegados, obtendremos directamente los datos desde internet, usando el paquete <code>{rvest}</code> que sirve para hacer scraping desde páginas web; es decir, descargar datos presentes en sitios de internet para usarlos directamente en R.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">library</span><span style="color:#908caa">(</span><span style="color:#ea9a97">rvest</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">tabla_comunas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">session</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;https://es.wikipedia.org/wiki/Anexo:Comunas_de_Chile&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># sitio web que scrapearemos</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">read_html</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># leemos el contenido del sitio web </span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">html_table</span><span style="color:#908caa">()</span> <span style="color:#6e6a86"># extraemos las tablas del sitio web</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">datos_comunas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">tabla_comunas[[1]]</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># elegimos la primera tabla obtenida</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">clean_names</span><span style="color:#908caa">()</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># limpiamos los nombres de la tabla usando {janitor}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">region</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Metropolitana de Santiago&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># convertir los códigos comunales a texto</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">rename</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_comuna</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">1</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_comuna</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.character</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># limpiar variables numéricas para estén disponibles en formato numérico en vez de como texto</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion2020</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion2020</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34; &#34;</span><span style="color:#908caa">),</span> <span style="color:#6e6a86"># borrar espacios</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">poblacion2020</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">poblacion2020</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>  <span style="color:#6e6a86"># transformar texto a numérico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># corregir superficie</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;\\.&#34;</span><span style="color:#908caa">),</span> <span style="color:#6e6a86"># borrar puntos separadores de miles</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_replace</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">),</span> <span style="color:#6e6a86"># reemplazar comas por puntos</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">superficie_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">superficie_km2</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> <span style="color:#6e6a86"># transformar texto a numérico</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># corregir densidad</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">mutate</span><span style="color:#908caa">(</span><span style="color:#ea9a97">densidad_hab_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_remove_all</span><span style="color:#908caa">(</span><span style="color:#ea9a97">densidad_hab_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;\\.&#34;</span><span style="color:#908caa">),</span> <span style="color:#6e6a86"># borrar puntos separadores de miles</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">densidad_hab_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">str_replace</span><span style="color:#908caa">(</span><span style="color:#ea9a97">densidad_hab_km2</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">),</span> <span style="color:#6e6a86"># reemplazar comas por puntos</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ea9a97">densidad_hab_km2</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">as.numeric</span><span style="color:#908caa">(</span><span style="color:#ea9a97">densidad_hab_km2</span><span style="color:#908caa">))</span> <span style="color:#6e6a86"># transformar texto a numérico</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">print</span><span style="color:#908caa">(</span><span style="color:#ea9a97">datos_comunas</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code># A tibble: 52 × 12
   codigo_comuna nombre      x     provincia region superficie_km2 poblacion2020
   &lt;chr&gt;         &lt;chr&gt;       &lt;lgl&gt; &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
 1 13101         Santiago    NA    Santiago  Metro…            232        503147
 2 13102         Cerrillos   NA    Santiago  Metro…             21         88956
 3 13103         Cerro Navia NA    Santiago  Metro…             11        142465
 4 13104         Conchalí    NA    Santiago  Metro…            107        139195
 5 13105         El Bosque   NA    Santiago  Metro…            142        172000
 6 13106         Estación C… NA    Santiago  Metro…             15        206792
 7 13107         Huechuraba  NA    Santiago  Metro…            448        112528
 8 13108         Independen… NA    Santiago  Metro…              7        142065
 9 13109         La Cisterna NA    Santiago  Metro…             10        100434
10 13110         La Florida  NA    Santiago  Metro…            702        402433
# ℹ 42 more rows
# ℹ 5 more variables: densidad_hab_km2 &lt;dbl&gt;, idh_2005 &lt;chr&gt;, idh_2005_2 &lt;chr&gt;,
#   latitud &lt;chr&gt;, longitud &lt;chr&gt;
</code></pre>
<p>Así quedó el resultado de nuestro web scraping. A continuación, usamos <code>left_join()</code> para adjuntar estas columnas nuevas a nuestro data frame que contiene los nombres y códigos de las comunas, además de la geometría o información geográfica de las comunas, usando como columna de unión los códigos comunales:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_datos_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">datos_comunas</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;codigo_comuna&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">glimpse</span><span style="color:#908caa">(</span><span style="color:#ea9a97">mapa_datos_2</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code>Rows: 52
Columns: 16
$ codigo_comuna    &lt;chr&gt; &quot;13404&quot;, &quot;13402&quot;, &quot;13124&quot;, &quot;13103&quot;, &quot;13301&quot;, &quot;13303&quot;,…
$ codigo_provincia &lt;chr&gt; &quot;134&quot;, &quot;134&quot;, &quot;131&quot;, &quot;131&quot;, &quot;133&quot;, &quot;133&quot;, &quot;133&quot;, &quot;131…
$ codigo_region    &lt;chr&gt; &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;, &quot;13&quot;,…
$ geometry         &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((-70.61396 -..., MULTIPOL…
$ nombre_comuna    &lt;chr&gt; &quot;Paine&quot;, &quot;Buin&quot;, &quot;Pudahuel&quot;, &quot;Cerro Navia&quot;, &quot;Colina&quot;,…
$ nombre           &lt;chr&gt; &quot;Paine&quot;, &quot;Buin&quot;, &quot;Pudahuel&quot;, &quot;Cerro Navia&quot;, &quot;Colina&quot;,…
$ x                &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ provincia        &lt;chr&gt; &quot;Maipo&quot;, &quot;Maipo&quot;, &quot;Santiago&quot;, &quot;Santiago&quot;, &quot;Chacabuco&quot;…
$ region           &lt;chr&gt; &quot;Metropolitana de Santiago&quot;, &quot;Metropolitana de Santia…
$ superficie_km2   &lt;dbl&gt; 820, 214, 197, 11, 9712, 653, 452, 448, 107, 3935, 69…
$ poblacion2020    &lt;dbl&gt; 82766, 109641, 253139, 142465, 180353, 21477, 126898,…
$ densidad_hab_km2 &lt;dbl&gt; 1009.0, 512.3, 1284.9, 12951.3, 185.7, 328.0, 280.7, …
$ idh_2005         &lt;chr&gt; &quot;0.718&quot;, &quot;0.731&quot;, &quot;0.735&quot;, &quot;0.683&quot;, &quot;0.726&quot;, &quot;0.709&quot;,…
$ idh_2005_2       &lt;chr&gt; &quot;Alto&quot;, &quot;Alto&quot;, &quot;Alto&quot;, &quot;Medio&quot;, &quot;Alto&quot;, &quot;Alto&quot;, &quot;Med…
$ latitud          &lt;chr&gt; &quot;-33°48'43.2\&quot;&quot;, &quot;-33°43'40.8\&quot;&quot;, &quot;-33°26'0\&quot;&quot;, &quot;-33°…
$ longitud         &lt;chr&gt; &quot;-70°43'22.8\&quot;&quot;, &quot;-70°44'20.4\&quot;&quot;, &quot;-70°43'0\&quot;&quot;, &quot;-70°…
</code></pre>
<p>Lo que hicimos en la operación anterior fue unir dos tablas distintas en base a una variable común que ambas tablas poseen: <code>codigo_comuna</code>. De este modo, obtenemos un nuevo data frame que contiene tanto la información geográfica como los datos comunales que necesitamos.</p>
<p>Habiendo hecho esto, ahora podemos crear gráficos comunales usando cualquier variable que queramos, siempre y cuando podamos hacer coincidir los datos con el mapa en base a los códigos comunales o los nombres de comuna.</p>




<h4 id="mapa-comunal-de-población-región-metropolitana-de-santiago-chile">Mapa comunal de población, Región Metropolitana de Santiago, Chile
  <a href="#mapa-comunal-de-poblaci%c3%b3n-regi%c3%b3n-metropolitana-de-santiago-chile"></a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_datos_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">poblacion2020</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">col</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">viridis</span><span style="color:#908caa">::</span><span style="color:#ea9a97">scale_fill_viridis</span><span style="color:#908caa">(</span><span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">decimal.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">labs</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Población&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_fill_continuo-1.png" width="768" />




<h4 id="mapa-comunal-del-índice-de-desarrollo-humano-región-metropolitana-de-santiago-chile">Mapa comunal del índice de desarrollo humano, Región Metropolitana de Santiago, Chile
  <a href="#mapa-comunal-del-%c3%adndice-de-desarrollo-humano-regi%c3%b3n-metropolitana-de-santiago-chile"></a>
</h4>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_datos_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>              <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">idh_2005_2</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">col</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">scale_fill_manual</span><span style="color:#908caa">(</span><span style="color:#ea9a97">breaks</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Medio&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Alto&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Muy alto&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#ea9a97">values</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Medio&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;olivedrab4&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Alto&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;olivedrab3&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Muy alto&#34;</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;olivedrab2&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">label</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">check_overlap</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">T</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">2</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">labs</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;IDH&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code>Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not
give correct results for longitude/latitude data
</code></pre>
<img src="index.markdown_strict_files/figure-markdown_strict/region_fill_categorico-1.png" width="768" />
<p>Sin embargo, podemos ver que estos mapas no se ajustan perfectamente a la imagen mental que tiene un ciudadano común acerca de cómo se ve la Región Metropolitana. Por ejemplo, vemos cómo la comuna de San José de Maipo abarca una superficie enorme dado que limita en la cordillera de los Andes con Argentina, o que comunas como Lo Barnechea se expanden hacia superficies cordilleranas de gran extensión.</p>
<p>Esto se debe a que ususalmente nos encontramos frente a mapas que representan el &ldquo;Gran Santiago&rdquo;, es decir, sólo la superficie urbana de las comunas urbanas de la región, omitiendo sectores rurales, cordilleranos o deshabitados.</p>
<p>Por lo tanto, a continuación veremos cómo obtener un mapa urbano de la Región Metropolitana de Santiago.</p>




<h2 id="mapa-urbano-de-la-región-metropolitana">Mapa urbano de la región Metropolitana
  <a href="#mapa-urbano-de-la-regi%c3%b3n-metropolitana"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>En los siguientes pasos, pasaremos de un mapa comunal a un mapa comunal urbano; es decir, un mapa que sólo considere la superficie urbana de las comunas, en vez de la superficie total de las comunas.</p>
<p>Usando <code>{chilemapas}</code>, podemos obtener un mapa de la Región Metropolitana con un nivel de detalle mayor, que divide internamente las comunas en superficies más pequeñas que sólo corresponden a zonas urbanas:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># obtener mapa por zonas rural/urbano</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">::</span><span style="color:#ea9a97">mapa_zonas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_region</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">13</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">chilemapas</span><span style="color:#908caa">::</span><span style="color:#ea9a97">codigos_territoriales</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#ea9a97">select</span><span style="color:#908caa">(</span><span style="color:#ea9a97">matches</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;comuna&#34;</span><span style="color:#908caa">)))</span>
</span></span></code></pre></div><pre><code>Joining with `by = join_by(codigo_comuna)`
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># mapa de zonas urbanas</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_zonas-1.png" width="768" />
<p>Podemos mejorar esta visualización uniendo las zonas urbanas intra-comunales en sus respectivas comunas, para volver a obtener un mapa comunal, pero que recorta las comunas para que sólo consideren su la superficie urbana de cada una:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># mapa de zonas urbanas</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># unir polígonos por comunas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">)</span> <span style="color:#908caa">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">summarise</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">st_union</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">.groups</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;drop&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># visualizar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_zonas_comunas-1.png" width="768" />
<p>De inmediato, podemos ver que emerge una figura más familiar de lo que es el <em>Gran Santiago,</em> pero ahora tenemos otro problema: el mapa también contiene las zonas urbanas de comunas menos céntricas de la región, tales como Buin, Curacaví, Talagante y otras. Esto se debe a que nuestro mapa aún contiene comunas que no son mayoritariamente urbanas, dado que poseen sectores despoblados o de actividad agrícola, minera u otras, y que por consiguiente dan una apariencia discontinua a nuestro mapa.</p>
<p>Para resolver esto y dejar sólo las comunas urbanas del Gran Santiago, tenemos varias opciones: podemos filtrar específicamente las comunas que queremos, o bien, podemos filtrar en base a privincias, dejando sólo las provincias Santiago y Cordillera.</p>




<h4 id="mapa-urbano-de-la-región-metropolitana-comunas-exactas">Mapa urbano de la región Metropolitana (comunas exactas)
  <a href="#mapa-urbano-de-la-regi%c3%b3n-metropolitana-comunas-exactas"></a>
</h4>
<p><strong>Opción 1:</strong> seleccionar específicamente las comunas que queremos incluir:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">comunas_urbanas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;Pudahuel&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Cerro Navia&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Conchali&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;La Pintana&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;El Bosque&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;Estacion Central&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Pedro Aguirre Cerda&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Recoleta&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Independencia&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;La Florida&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Penalolen&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Las Condes&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Lo Barnechea&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Quinta Normal&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;Maipu&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Macul&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Nunoa&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Puente Alto&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Quilicura&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Renca&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;San Bernardo&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;San Miguel&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;La Granja&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Providencia&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Santiago&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;San Joaquin&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Lo Espejo&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;La Reina&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;San Ramon&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;La Cisterna&#34;</span><span style="color:#908caa">,</span> 
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;Lo Prado&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Cerrillos&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Vitacura&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;Huechuraba&#34;</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#f6c177">&#34;San Jose de Maipo&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># mapa de sectores urbanos, de comunas urbanas</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># filtrar comunas urbanas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">%in%</span> <span style="color:#ea9a97">comunas_urbanas</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># unir polígonos por comunas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">)</span> <span style="color:#908caa">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">summarise</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">st_union</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># graficar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><pre><code>`summarise()` has grouped output by 'nombre_comuna'. You can override using the
`.groups` argument.
</code></pre>
<img src="index.markdown_strict_files/figure-markdown_strict/region_urbano_opcion1-1.png" width="768" />




<h4 id="mapa-urbano-de-la-región-metropolitana-provincias-santiago-y-cordillera">Mapa urbano de la región Metropolitana (provincias Santiago y Cordillera)
  <a href="#mapa-urbano-de-la-regi%c3%b3n-metropolitana-provincias-santiago-y-cordillera"></a>
</h4>
<p><strong>Opción 2:</strong> seleccionar las dos provincias que conforman el Gran Santiago, y agregar los ajustes que sean necesarios (incluir San Bernardo, excluir Pirque)</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># dejar solo dos provincias, incluir San Bernardo y sacar Pirque</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">codigo_provincia</span> <span style="color:#908caa">%in%</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">131</span><span style="color:#908caa">,</span> <span style="color:#f6c177">132</span><span style="color:#908caa">)</span> <span style="color:#908caa">|</span> <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;San Bernardo&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">!=</span> <span style="color:#f6c177">&#34;Pirque&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># unir polígonos por comunas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">)</span> <span style="color:#908caa">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">summarise</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">st_union</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># graficar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey60&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><pre><code>`summarise()` has grouped output by 'nombre_comuna'. You can override using the
`.groups` argument.
</code></pre>
<img src="index.markdown_strict_files/figure-markdown_strict/region_urbano_opcion2-1.png" width="768" />
<p>La decisión que tomes depende de los objetivos del usuario y de tu visualzación, pero dejo ambas aproximaciones a modo de aprendizaje.</p>
<p>Luego de haber seleccionado las comunas urbanas que necesitamos, notamos que aún quedan algunas &ldquo;islas urbanas&rdquo; fuera de la zona principal del Gran Santiago. Usualmente vemos los mapas del Gran Santiago como una sola unidad geográfica contínua, sin separaciones ni islas a su alrededor. Por lo tanto, vamos a eliminar estos elementos externos a la superficie urbana contínua de forma manual.</p>
<p>Para identificar los polígonos que queramos remover, podemos visualizar una fracción del mapa y agregar etiquetas para dar con sus códigos geográficos, y así poder excluirlos. Por ejemplo, aquí lo haremos con Pudahuel:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">==</span> <span style="color:#f6c177">&#34;Pudahuel&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;lightblue&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf_text</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">label</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geocodigo</span><span style="color:#908caa">),</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;black&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">size</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">3</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><pre><code>Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not
give correct results for longitude/latitude data
</code></pre>
<img src="index.markdown_strict_files/figure-markdown_strict/prueba_islas-1.png" width="768" />
<p>Bastaría con anotar los geocódigos para filtrarlos.</p>
<p>Entonces, en el siguiente paso removeremos estas pequeñas zonas urbanas de forma manual para obtener un mapa más contínuo.</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># vector con geocódigos que deseamor remover</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">islas_urbanas</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">&#34;13124071004&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13124071005&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13124081001&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13124071001&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13124071002&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13124071003&#34;</span><span style="color:#908caa">,</span> <span style="color:#6e6a86">#Pudahuel</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#f6c177">&#34;13401121001&#34;</span><span style="color:#908caa">,</span> <span style="color:#6e6a86">#San Bernardo</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#f6c177">&#34;13119131001&#34;</span><span style="color:#908caa">,</span> <span style="color:#6e6a86">#Maipú</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#f6c177">&#34;13203031000&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13203031001&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13203031002&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13203011001&#34;</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;13203011002&#34;</span> <span style="color:#6e6a86">#San José de Maipo</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># crear nuevo mapa</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_urbano</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_zonas_urbanas</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># filtrar solo comunas urbanas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span> <span style="color:#908caa">%in%</span> <span style="color:#ea9a97">comunas_urbanas</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># filtrar islas urbanas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">filter</span><span style="color:#908caa">(</span><span style="color:#908caa">!</span><span style="color:#ea9a97">geocodigo</span> <span style="color:#908caa">%in%</span> <span style="color:#ea9a97">islas_urbanas</span><span style="color:#908caa">)</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># unir comunas</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">group_by</span><span style="color:#908caa">(</span><span style="color:#ea9a97">nombre_comuna</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">codigo_comuna</span><span style="color:#908caa">)</span> <span style="color:#908caa">%&gt;%</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">summarise</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">st_union</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ungroup</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><pre><code>`summarise()` has grouped output by 'nombre_comuna'. You can override using the
`.groups` argument.
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>  <span style="color:#6e6a86"># simplificar bordes del mapa (opcional)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6e6a86"># mutate(geometry = rmapshaper::ms_simplify(geometry,  keep = 0.4))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86"># graficar</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_urbano</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;blueviolet&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/remover_islas-1.png" width="768" />
<p>De esta forma ya logramos graficar un mapa del Gran Santiago mucho más definido y limpio.</p>
<p>Teniendo este mapa, procedemos a visualizar nuestros datos tal como hicimos al principio de este tutorial:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># volvemos a adjuntar los datos que descargamos usando web scraping, esta vez al mapa nuevo</span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_urbano_2</span> <span style="color:#908caa">&lt;-</span> <span style="color:#ea9a97">mapa_urbano</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">left_join</span><span style="color:#908caa">(</span><span style="color:#ea9a97">datos_comunas</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">by</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;codigo_comuna&#34;</span><span style="color:#908caa">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ea9a97">mapa_urbano_2</span> <span style="color:#908caa">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">densidad_hab_km2</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">col</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">viridis</span><span style="color:#908caa">::</span><span style="color:#ea9a97">scale_fill_viridis</span><span style="color:#908caa">(</span><span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">decimal.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">option</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;magma&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">labs</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Densidad poblacional&#34;</span><span style="color:#908caa">)</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_urbana_fill_continuo-1.png" width="768" />
<p>Finalmente, podemos poner nuestro nuevo mapa urbano de la Región Metropolitana de Santiago sobre el mapa de la región completa:</p>
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#ea9a97">ggplot</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">data</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">mapa</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;grey95&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.5</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">geom_sf</span><span style="color:#908caa">(</span><span style="color:#ea9a97">data</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">mapa_urbano_2</span><span style="color:#908caa">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">aes</span><span style="color:#908caa">(</span><span style="color:#ea9a97">geometry</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">geometry</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">poblacion2020</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ea9a97">color</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;white&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">linewidth</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">0.2</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">viridis</span><span style="color:#908caa">::</span><span style="color:#ea9a97">scale_fill_viridis</span><span style="color:#908caa">(</span><span style="color:#ea9a97">labels</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">label_number</span><span style="color:#908caa">(</span><span style="color:#ea9a97">big.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;.&#34;</span><span style="color:#908caa">,</span> <span style="color:#ea9a97">decimal.mark</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;,&#34;</span><span style="color:#908caa">),</span> 
</span></span><span style="display:flex;"><span>                              <span style="color:#ea9a97">option</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;mako&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme_void</span><span style="color:#908caa">()</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">labs</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;Población&#34;</span><span style="color:#908caa">)</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">guides</span><span style="color:#908caa">(</span><span style="color:#ea9a97">fill</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">guide_colourbar</span><span style="color:#908caa">(</span><span style="color:#ea9a97">position</span> <span style="color:#908caa">=</span> <span style="color:#f6c177">&#34;inside&#34;</span><span style="color:#908caa">))</span> <span style="color:#908caa">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ea9a97">theme</span><span style="color:#908caa">(</span><span style="color:#ea9a97">legend.position.inside</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">c</span><span style="color:#908caa">(</span><span style="color:#f6c177">.1</span><span style="color:#908caa">,</span> <span style="color:#f6c177">.7</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ea9a97">legend.key.width</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">3</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ea9a97">legend.key.height</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">10</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ea9a97">legend.ticks.length</span> <span style="color:#908caa">=</span> <span style="color:#ea9a97">unit</span><span style="color:#908caa">(</span><span style="color:#f6c177">0.4</span><span style="color:#908caa">,</span> <span style="color:#f6c177">&#34;mm&#34;</span><span style="color:#908caa">))</span>
</span></span></code></pre></div><img src="index.markdown_strict_files/figure-markdown_strict/region_urbana_fill_continuo_contexto-1.png" width="768" />
<div class="highlight"><pre tabindex="0" style="color:#e0def4;background-color:#232136;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#6e6a86"># ggplot() +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   geom_sf(data = mapa,</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#           aes(geometry = geometry), </span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#           fill = &#34;grey90&#34;, color = &#34;white&#34;, linewidth = 0.4) +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   geom_sf(data = mapa_urbano_2,</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#           aes(geometry = geometry, fill = poblacion2020),</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#           color = &#34;white&#34;, linewidth = 0.2) +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   coord_sf(xlim = c(-70.95, -70.3), ylim = c(-33.86, -33.13), expand = F) +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   viridis::scale_fill_viridis(labels = label_number(big.mark = &#34;.&#34;, decimal.mark = &#34;,&#34;), </span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#                               option = &#34;mako&#34;) +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   theme_void() +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   labs(fill = &#34;Población&#34;) +</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#   theme(legend.position.inside = c(.5, .08),</span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#         legend.direction = &#34;horizontal&#34;, </span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#         legend.key.width = unit(15, &#34;mm&#34;), </span>
</span></span><span style="display:flex;"><span><span style="color:#6e6a86">#         legend.key.height = unit(3, &#34;mm&#34;), legend.ticks = element_blank(), legend.title.position = &#34;top&#34;)</span>
</span></span></code></pre></div><hr>
<p><strong>Bastián Olea Herrera</strong></p>
<p>Analista de datos, magíster en Sociología (PUC)</p>
<p>
<a href="http://bastian.olea.biz" target="_blank" rel="noopener">http://bastian.olea.biz</a></p>
<p>
<a href="%5Bhttps://bastianolea.github.io/shiny_apps/">Ver más recursos de aprendizaje de R y visualizadores de datos sociales de código abierto programados en R</a></p>

        
        <details closed class="f6 fw7 input-reset">
  <dl class="f6 lh-copy">
    <dt class="fw7">Fecha de publicación:</dt>
    <dd class="fw5 ml0">June 12, 2024</dd>
  </dl>
  <dl class="f6 lh-copy">
    <dt class="fw7">Extensión:</dt>
    <dd class="fw5 ml0">14 minute read, 2782 words</dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Categorías:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/categories/tutoriales">Tutoriales</a> </dd>
  </dl>
  
  
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Tags:</dt>
    <dd class="fw5 ml0"> <a href="http://localhost:4321/tags/mapas">mapas</a>  <a href="http://localhost:4321/tags/chile">chile</a>  <a href="http://localhost:4321/tags/gr%C3%A1ficos">gráficos</a> </dd>
  </dl>
  
  <dl class="f6 lh-copy">
    <dt class="fw7">Ver también:</dt>
    
    <dd class="fw5 ml0"><a href="/blog/portafolio_trabajos_r/">Portafolio de trabajos previos en R</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/ggplot_nubes/">¿Arte? Nubes aleatorias en {ggplot2}</a></dd>
    
    <dd class="fw5 ml0"><a href="/blog/elecciones_municipales_2024/">Visualización y scraping de resultados en vivo de las elecciones municipales 2024</a></dd>
    
  </dl>
</details>

      </section>
      <footer class="post-footer">
        <div class="post-pagination dt w-100 mt4 mb2">
  
  
    <a class="prev dtc pr2 tl v-top fw6"
    href="http://localhost:4321/blog/tema_morado/">&larr; Tema morado oscuro para RStudio</a>
  
  
  
    <a class="next dtc pl2 tr v-top fw6"
    href="http://localhost:4321/blog/tutorial_delitos_cead/">Tutorial: Scraping de estadísticas delictuales del Centro de Estudios y Análisis del Delito con R &rarr;</a>
  
</div>

      </footer>
    </article>
    
      <div class="post-comments pa0 pa4-l mt4">
  
    
      <script src="https://utteranc.es/client.js"
              repo="bastianolea/blog-bastianolea-r"
              issue-term="pathname"
              theme="github-light"
              label="comments"
              crossorigin="anonymous"
              async
              type="text/javascript">
      </script>
    
  
</div>

    
  </section>
</main>
<footer class="site-footer pv4 bt b--transparent ph5" role="contentinfo">
  <nav class="db dt-l w-100">
    <p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">
      &copy; 2024 Bastián Olea Herrera, Chile
      <span class="middot-divider"></span>
      Hecho con <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/hugo-apero/" rel="dct:source">Hugo Apéro</a></span>.
      <br />
      
Basado en <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/formspree/blogophonic-hugo" rel="dct:source">Blogophonic</a></span>, de <a xmlns:cc="http://creativecommons.org/ns#" href="https://formspree.io" property="cc:attributionName" rel="cc:attributionURL">Formspree</a>.
    </p>
    
    <div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0">
      <div class="social-icon-links" aria-hidden="true">
  
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://github.com/bastianolea" title="github" target="_blank" rel="me noopener">
      <i class="fab fa-github fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://x.com/bastimapache" title="twitter" target="_blank" rel="me noopener">
      <i class="fab fa-twitter fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://bsky.app/profile/bastianolea.rbind.io" title="bluesky" target="_blank" rel="me noopener">
      <i class="fab fa-bluesky fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.linkedin.com/in/bastianolea/" title="linkedin" target="_blank" rel="me noopener">
      <i class="fab fa-linkedin fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.instagram.com/raccunnie" title="instagram" target="_blank" rel="me noopener">
      <i class="fab fa-instagram fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="https://www.goodreads.com/user/show/53224910-basti-n-olea-herrera" title="goodreads" target="_blank" rel="me noopener">
      <i class="fab fa-goodreads fa-lg fa-fw"></i>
    </a>
  
    
    
    
      
    
    
    
    
    
      
    
    <a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href="/contact/" title="envelope" >
      <i class="fas fa-envelope fa-lg fa-fw"></i>
    </a>
  
</div>

    </div>
    
    <div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0">
      
      <a class="dib pv1 ph2 link" href="/about/" title="Bastián Olea: Sobre mi">Sobre mi</a>
      
      <a class="dib pv1 ph2 link" href="/contact/" title="Bastián Olea: Contacto">Contacto</a>
      
      <a class="dib pv1 ph2 link" href="/license/" title="Bastián Olea: Licencia">Licencia</a>
      
    </div>
  </nav>
  
    <script>

    var i, text, code, codes = document.getElementsByTagName('code');
    for (let i = 0; i < codes.length;) {
      code = codes[i];
      if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
        text = code.textContent;
        if (/^\$[^$]/.test(text) && /[^$]\$$/.test(text)) {
          text = text.replace(/^\$/, '\\(').replace(/\$$/, '\\)');
          code.textContent = text;
        }
        if (/^\\\((.|\s)+\\\)$/.test(text) ||
            /^\\\[(.|\s)+\\\]$/.test(text) ||
            /^\$(.|\s)+\$$/.test(text) ||
            /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
          code.outerHTML = code.innerHTML;  
          continue;
        }
      }
      i++;
    }
</script>

  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>



    
  
  
</footer>

      </div>
    </body>
</html>
